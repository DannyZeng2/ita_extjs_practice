<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="../../resources/css/ext-all.css" />
    <script type="text/javascript" src="../../adapter/ext/ext-base.js"></script>
    <script type="text/javascript" src="../../ext-all-debug.js"></script>
    <script type="text/javascript">
        Ext.onReady(function () {
            var root = new Ext.tree.AsyncTreeNode({ text: '广东省' });

            var menu = new Ext.menu.Menu({
                items: [{
                    id: 'showInfo',
                    text: 'Show Information'
                }],
                listeners: {
                    itemclick: function (item) {
                        switch (item.id) {
                            case 'showInfo':
                                var node = item.parentMenu.contextNode;
                                if (node.parentNode) {
                                    Ext.Msg.alert('当前位置', node.parentNode.text + node.text);
                                } else if (node) {
                                    Ext.Msg.alert('当前位置', node.text);
                                }
                                break;
                        }
                    }
                }
            });

            var tree = new Ext.tree.TreePanel({
                renderTo: 'tree',
                title: "选择省份",
                width: 200,
                height: 300,
                animate: true,
                enableDD: true,
                root: root,
                loader: new Ext.tree.TreeLoader({ dataUrl: 'tree.txt' }),
                selModel: new Ext.tree.MultiSelectionModel({}),
                contextMenu: menu,
                listeners: {
                    contextmenu: function (node, e) {
                        // node.select();
                        var treeContextMenu = node.getOwnerTree().contextMenu;
                        treeContextMenu.contextNode = node;
                        treeContextMenu.showAt(e.getXY());
                    },
                    collapsenode: function (node) {
                        Ext.Msg.alert('Tree Event', node.text + "已收缩");
                    }
                }


            });

            // tree.on('expandnode', function (node) {
            //     Ext.Msg.alert('Tree Event', node.text + "已展开");
            // });

            var treeEditor = new Ext.tree.TreeEditor(tree, { allowBlank: false }, {
                listeners: {
                    complete: function (editor, currVal, origVal) {
                        if (currVal.indexOf('Zh') != -1) {
                            editor.editNode.setCls('chang_red');
                            //editor.boundEl.dom.style.color = 'red';
                        }
                        Ext.Msg.alert('修改成功', origVal + '已修改为' + currVal);

                    },

                }
            });

            tree.render();

        });
    </script>
    <style>
        .chang_red span {
            color: red;
        }
    </style>
</head>

<body>
    <div id='tree'></div>
</body>

</html>